# üöÄ Production Deployment Guide for PeopleRate

## Overview
This guide covers deploying PeopleRate to production on **Render.com** (free tier available).

**Deployment Stack:**
- **Platform:** Render.com (Web Service)
- **Database:** MongoDB Atlas (Free M0 cluster)
- **Storage:** Render Disk (1GB free for uploads)
- **Domain:** Render subdomain (or custom domain)

---

## Pre-Deployment Checklist

### ‚úÖ Code Readiness
- [x] All features implemented (11/11 complete)
- [x] Security hardening (rate limiting, CORS, headers)
- [x] Content moderation (profanity filter, flagging)
- [x] Legal documents (ToS, Privacy Policy)
- [x] Error handling (404/500 pages)
- [x] OAuth integration (optional but ready)
- [x] Email verification (file-based MVP ready)
- [x] Profile claiming system
- [x] Proof-based review verification
- [x] Social sharing (Open Graph, Twitter Cards)
- [x] Verification badges (email, LinkedIn, company)

### ‚úÖ Configuration Files
- [x] `render.yaml` - Deployment configuration
- [x] `requirements.txt` - Python dependencies (21 packages)
- [x] `.env.example` - Environment template
- [x] `DEPLOYMENT.md` - This guide
- [x] `OAUTH_SETUP.md` - OAuth configuration instructions
- [x] `SECURITY.md` - Security documentation

### ‚è∏Ô∏è Optional (For Enhanced Production)
- [ ] OAuth provider apps created (Google, LinkedIn, Facebook, GitHub)
- [ ] SendGrid account (for email instead of file-based mock)
- [ ] Google Analytics / Plausible setup
- [ ] Custom domain purchased
- [ ] SSL certificate (auto-provided by Render)

---

## Step 1: MongoDB Atlas Setup (5 minutes)

### 1.1 Create Free Cluster
1. Go to [MongoDB Atlas](https://cloud.mongodb.com/)
2. Sign up / Log in
3. Create new project: `PeopleRate`
4. Create cluster: **FREE M0** (0.5GB storage)
5. Choose cloud provider: **AWS** (recommended)
6. Region: Choose closest to Render region (Oregon = us-west-2)

### 1.2 Configure Security
1. **Database Access:**
   - Username: `peopleRate_user` (already configured)
   - Password: Your secure password (update in .env)
   - Database: `peopleRate_db`
   - Role: `Read and write to any database`

2. **Network Access:**
   - Click `Add IP Address`
   - Select `Allow access from anywhere` (0.0.0.0/0)
   - Note: This is safe because authentication is required
   - For extra security, restrict to Render IPs later

### 1.3 Get Connection String
1. Click `Connect` on your cluster
2. Choose `Connect your application`
3. Driver: **Python**, Version: **3.11 or later**
4. Copy connection string:
   ```
   mongodb+srv://peopleRate_user:<password>@peoplerate.hwtjr0g.mongodb.net/?retryWrites=true&w=majority
   ```
5. Replace `<password>` with your actual password
6. Keep this string safe - you'll need it for Render

### 1.4 Initialize Sample Data (Optional)
```bash
# Update .env with MongoDB URL
MONGODB_URL=mongodb+srv://peopleRate_user:YourPassword@peoplerate.hwtjr0g.mongodb.net/

# Run initialization script
python scripts/init_sample_data.py
```

---

## Step 2: Render.com Setup (10 minutes)

### 2.1 Create Account
1. Go to [Render.com](https://render.com/)
2. Sign up with GitHub (recommended for auto-deploy)
3. Connect your GitHub account
4. Grant access to your PeopleRate repository

### 2.2 Create Web Service
1. Click `New +` ‚Üí `Web Service`
2. Connect repository: `your-username/PeopleRate`
3. Configure service:
   - **Name:** `peoplerate` (or your preferred name)
   - **Region:** Oregon (US West) - Free tier available
   - **Branch:** `main`
   - **Runtime:** Python 3
   - **Build Command:** `pip install -r requirements.txt`
   - **Start Command:** `uvicorn main:app --host 0.0.0.0 --port $PORT`
   - **Plan:** Free ($0/month) - Spins down after inactivity

### 2.3 Configure Environment Variables
In Render dashboard, add these environment variables:

**Required:**
```bash
MONGODB_URL=mongodb+srv://peopleRate_user:YourPassword@peoplerate.hwtjr0g.mongodb.net/
DATABASE_NAME=peopleRate_db
SECRET_KEY=<auto-generated-by-render>
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
ENVIRONMENT=production
CORS_ORIGINS=https://peoplerate.onrender.com  # Update with your actual URL
PYTHON_VERSION=3.11.0
```

**Optional (OAuth):**
```bash
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_secret
LINKEDIN_CLIENT_ID=your_linkedin_client_id
LINKEDIN_CLIENT_SECRET=your_linkedin_secret
FACEBOOK_CLIENT_ID=your_facebook_app_id
FACEBOOK_CLIENT_SECRET=your_facebook_secret
GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_secret
```

### 2.4 Add Disk Storage (For File Uploads)
1. In service settings, go to `Disks`
2. Add disk:
   - **Name:** `peoplerate-uploads`
   - **Mount Path:** `/opt/render/project/src/uploads`
   - **Size:** 1GB (free tier)

### 2.5 Deploy
1. Click `Create Web Service`
2. Wait for deployment (2-5 minutes)
3. Watch build logs for errors
4. Once deployed, note your URL: `https://peoplerate.onrender.com`

---

## Step 3: Post-Deployment Testing

### 3.1 Test Core Features
1. Visit: `https://peoplerate.onrender.com`
2. Create account or login with test account
3. Search for a person (test: "Alice Johnson")
4. Write a review with ratings
5. Test profile claiming workflow
6. Test OAuth login (if configured)
7. Check admin dashboard: `/admin/dashboard`
8. Upload profile photo and review proof
9. Test social sharing buttons

### 3.2 Update OAuth Callback URLs (If Using OAuth)
Update all provider dashboards with production callback URL:

**Google:** `https://peoplerate.onrender.com/auth/oauth/google/callback`  
**LinkedIn:** `https://peoplerate.onrender.com/auth/oauth/linkedin/callback`  
**Facebook:** `https://peoplerate.onrender.com/auth/oauth/facebook/callback`  
**GitHub:** `https://peoplerate.onrender.com/auth/oauth/github/callback`

---

## Cost Breakdown

### Free Tier (MVP Testing)
- **Render:** $0/month (sleeps after 15min)
- **MongoDB Atlas:** $0/month (M0 cluster, 512MB)
- **Total:** **$0/month** üéâ

### Starter Tier (Launch)
- **Render Starter:** $7/month (always-on, 512MB RAM)
- **MongoDB M0:** $0/month (sufficient for 1000s of users)
- **Total:** **$7/month**

### Growth Tier (1000+ active users)
- **Render Standard:** $25/month (2GB RAM)
- **MongoDB M2:** $9/month (2GB storage, dedicated)
- **Total:** **$34/month**

---

## Deployment Status

**Current Status:** ‚úÖ **READY TO DEPLOY**

**Deployment Readiness:**
- Code: 100% complete (11/11 features)
- Security: Production-ready
- Legal: Compliant
- Infrastructure: Configured
- Documentation: Complete

**Blocked By:**
- User decision to deploy (ready when you are!)
- Optional: OAuth provider app creation
- Optional: Custom domain purchase

**Deployment Time:** ~20 minutes (first time)

---

**For detailed troubleshooting and advanced configuration, see project documentation.**
